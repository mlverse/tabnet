<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Tabnet model — tabnet_pretrain • tabnet</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Tabnet model — tabnet_pretrain"><meta property="og:description" content="Pretrain the TabNet: Attentive Interpretable Tabular Learning model
on the predictor data exclusively (unsupervised training)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tabnet</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Hierarchical_classification.html">Hierarchical Classification</a>
    </li>
    <li>
      <a href="../articles/interpretation.html">Interpretation tools</a>
    </li>
    <li>
      <a href="../articles/Missing_data_predictors.html">Training a Tabnet model from missing-values dataset</a>
    </li>
    <li>
      <a href="../articles/selfsupervised_training.html">Self-supervised training and fine-tuning</a>
    </li>
    <li>
      <a href="../articles/tidymodels-interface.html">Fitting tabnet with tidymodels</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mlverse/tabnet/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Tabnet model</h1>
    <small class="dont-index">Source: <a href="https://github.com/mlverse/tabnet/blob/main/R/hardhat.R" class="external-link"><code>R/hardhat.R</code></a></small>
    <div class="hidden name"><code>tabnet_pretrain.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Pretrain the <a href="https://arxiv.org/abs/1908.07442" class="external-link">TabNet: Attentive Interpretable Tabular Learning</a> model
on the predictor data exclusively (unsupervised training).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tabnet_pretrain</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">tabnet_pretrain</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'data.frame'</span></span>
<span><span class="fu">tabnet_pretrain</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  tabnet_model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  config <span class="op">=</span> <span class="fu"><a href="tabnet_config.html">tabnet_config</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  from_epoch <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'formula'</span></span>
<span><span class="fu">tabnet_pretrain</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  tabnet_model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  config <span class="op">=</span> <span class="fu"><a href="tabnet_config.html">tabnet_config</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  from_epoch <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'recipe'</span></span>
<span><span class="fu">tabnet_pretrain</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  tabnet_model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  config <span class="op">=</span> <span class="fu"><a href="tabnet_config.html">tabnet_config</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  from_epoch <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'Node'</span></span>
<span><span class="fu">tabnet_pretrain</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  tabnet_model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  config <span class="op">=</span> <span class="fu"><a href="tabnet_config.html">tabnet_config</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  from_epoch <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Depending on the context:</p><ul><li><p>A <strong>data frame</strong> of predictors.</p></li>
<li><p>A <strong>matrix</strong> of predictors.</p></li>
<li><p>A <strong>recipe</strong> specifying a set of preprocessing steps
created from <code><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipes::recipe()</a></code>.</p></li>
<li><p>A <strong>Node</strong> where tree leaves will be left out,
and attributes will be used as predictors.</p></li>
</ul><p>The predictor data should be standardized (e.g. centered or scaled).
The model treats categorical predictors internally thus, you don't need to
make any treatment.
The model treats missing values internally thus, you don't need to make any
treatment.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Model hyperparameters.
Any hyperparameters set here will update those set by the config argument.
See <code><a href="tabnet_config.html">tabnet_config()</a></code> for a list of all possible hyperparameters.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>(optional) When <code>x</code> is a <strong>data frame</strong> or <strong>matrix</strong>, <code>y</code> is the outcome</p></dd>


<dt id="arg-tabnet-model">tabnet_model<a class="anchor" aria-label="anchor" href="#arg-tabnet-model"></a></dt>
<dd><p>A pretrained <code>tabnet_model</code> object to continue the fitting on.
if <code>NULL</code> (the default) a brand new model is initialized.</p></dd>


<dt id="arg-config">config<a class="anchor" aria-label="anchor" href="#arg-config"></a></dt>
<dd><p>A set of hyperparameters created using the <code>tabnet_config</code> function.
If no argument is supplied, this will use the default values in <code><a href="tabnet_config.html">tabnet_config()</a></code>.</p></dd>


<dt id="arg-from-epoch">from_epoch<a class="anchor" aria-label="anchor" href="#arg-from-epoch"></a></dt>
<dd><p>When a <code>tabnet_model</code> is provided, restore the network weights from a specific epoch.
Default is last available checkpoint for restored model, or last epoch for in-memory model.</p></dd>


<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>A formula specifying the outcome terms on the left-hand side,
and the predictor terms on the right-hand side.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>When a <strong>recipe</strong> or <strong>formula</strong> is used, <code>data</code> is specified as:</p><ul><li><p>A <strong>data frame</strong> containing both the predictors and the outcome.</p></li>
</ul></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A TabNet model object. It can be used for serialization, predictions, or further fitting.</p>
    </div>
    <div id="outcome">
    <h2>outcome</h2>



<p>Outcome value are accepted here only for consistent syntax with <code>tabnet_fit</code>, but
by design the outcome, if present, is ignored during pre-training.</p>
    </div>
    <div id="pre-training-from-a-previous-model">
    <h2>pre-training from a previous model</h2>



<p>When providing a parent <code>tabnet_model</code> parameter, the model pretraining resumes from that model weights
at the following epoch:</p><ul><li><p>last pretrained epoch for a model already in torch context</p></li>
<li><p>Last model checkpoint epoch for a model loaded from file</p></li>
<li><p>the epoch related to a checkpoint matching or preceding the <code>from_epoch</code> value if provided
The model pretraining metrics append on top of the parent metrics in the returned TabNet model.</p></li>
</ul></div>
    <div id="threading">
    <h2>Threading</h2>



<p>TabNet uses <code>torch</code> as its backend for computation and <code>torch</code> uses all
available threads by default.</p>
<p>You can control the number of threads used by <code>torch</code> with:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>torch<span class="sc">::</span><span class="fu">torch_set_num_threads</span>(<span class="dv">1</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>torch<span class="sc">::</span><span class="fu">torch_set_num_interop_threads</span>(<span class="dv">1</span>)</span></code></pre><p></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ames"</span>, package <span class="op">=</span> <span class="st">"modeldata"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pretrained</span> <span class="op">&lt;-</span> <span class="fu">tabnet_pretrain</span><span class="op">(</span><span class="va">Sale_Price</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">ames</span>, epochs <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Daniel Falbel, Christophe Regouby.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

