<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Tabnet model — tabnet_fit • tabnet</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tabnet model — tabnet_fit"><meta name="description" content="Fits the TabNet: Attentive Interpretable Tabular Learning model"><meta property="og:description" content="Fits the TabNet: Attentive Interpretable Tabular Learning model"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tabnet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/aum_loss.html">Using ROC AUM loss for imbalanced binary classification</a></li>
    <li><a class="dropdown-item" href="../articles/Hierarchical_classification.html">Hierarchical Classification</a></li>
    <li><a class="dropdown-item" href="../articles/interpretation.html">Interpretation tools</a></li>
    <li><a class="dropdown-item" href="../articles/Missing_data_predictors.html">Training a Tabnet model from missing-values dataset</a></li>
    <li><a class="dropdown-item" href="../articles/selfsupervised_training.html">Self-supervised training and fine-tuning</a></li>
    <li><a class="dropdown-item" href="../articles/tidymodels-interface.html">Fitting tabnet with tidymodels</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mlverse/tabnet/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Tabnet model</h1>
      <small class="dont-index">Source: <a href="https://github.com/mlverse/tabnet/blob/main/R/hardhat.R" class="external-link"><code>R/hardhat.R</code></a></small>
      <div class="d-none name"><code>tabnet_fit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits the <a href="https://arxiv.org/abs/1908.07442" class="external-link">TabNet: Attentive Interpretable Tabular Learning</a> model</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tabnet_fit</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">tabnet_fit</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'data.frame'</span></span>
<span><span class="fu">tabnet_fit</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  tabnet_model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  config <span class="op">=</span> <span class="fu"><a href="tabnet_config.html">tabnet_config</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  from_epoch <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'formula'</span></span>
<span><span class="fu">tabnet_fit</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  tabnet_model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  config <span class="op">=</span> <span class="fu"><a href="tabnet_config.html">tabnet_config</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  from_epoch <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'recipe'</span></span>
<span><span class="fu">tabnet_fit</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  tabnet_model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  config <span class="op">=</span> <span class="fu"><a href="tabnet_config.html">tabnet_config</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  from_epoch <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'Node'</span></span>
<span><span class="fu">tabnet_fit</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  tabnet_model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  config <span class="op">=</span> <span class="fu"><a href="tabnet_config.html">tabnet_config</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  from_epoch <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Depending on the context:</p><ul><li><p>A <strong>data frame</strong> of predictors.</p></li>
<li><p>A <strong>matrix</strong> of predictors.</p></li>
<li><p>A <strong>recipe</strong> specifying a set of preprocessing steps
created from <code><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipes::recipe()</a></code>.</p></li>
<li><p>A <strong>Node</strong> where tree will be used as hierarchical outcome,
and attributes will be used as predictors.</p></li>
</ul><p>The predictor data should be standardized (e.g. centered or scaled).
The model treats categorical predictors internally thus, you don't need to
make any treatment.
The model treats missing values internally thus, you don't need to make any
treatment.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Model hyperparameters.
Any hyperparameters set here will update those set by the config argument.
See <code><a href="tabnet_config.html">tabnet_config()</a></code> for a list of all possible hyperparameters.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>When <code>x</code> is a <strong>data frame</strong> or <strong>matrix</strong>, <code>y</code> is the outcome
specified as:</p><ul><li><p>A <strong>data frame</strong> with 1 or many numeric column (regression) or 1 or many categorical columns (classification) .</p></li>
<li><p>A <strong>matrix</strong> with 1 column.</p></li>
<li><p>A <strong>vector</strong>, either numeric or categorical.</p></li>
</ul></dd>


<dt id="arg-tabnet-model">tabnet_model<a class="anchor" aria-label="anchor" href="#arg-tabnet-model"></a></dt>
<dd><p>A previously fitted <code>tabnet_model</code> object to continue the fitting on.
if <code>NULL</code> (the default) a brand new model is initialized.</p></dd>


<dt id="arg-config">config<a class="anchor" aria-label="anchor" href="#arg-config"></a></dt>
<dd><p>A set of hyperparameters created using the <code>tabnet_config</code> function.
If no argument is supplied, this will use the default values in <code><a href="tabnet_config.html">tabnet_config()</a></code>.</p></dd>


<dt id="arg-from-epoch">from_epoch<a class="anchor" aria-label="anchor" href="#arg-from-epoch"></a></dt>
<dd><p>When a <code>tabnet_model</code> is provided, restore the network weights from a specific epoch.
Default is last available checkpoint for restored model, or last epoch for in-memory model.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>Unused. Placeholder for hardhat::importance_weight() variables.</p></dd>


<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>A formula specifying the outcome terms on the left-hand side,
and the predictor terms on the right-hand side.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>When a <strong>recipe</strong> or <strong>formula</strong> is used, <code>data</code> is specified as:</p><ul><li><p>A <strong>data frame</strong> containing both the predictors and the outcome.</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A TabNet model object. It can be used for serialization, predictions, or further fitting.</p>
    </div>
    <div class="section level2">
    <h2 id="fitting-a-pre-trained-model">Fitting a pre-trained model<a class="anchor" aria-label="anchor" href="#fitting-a-pre-trained-model"></a></h2>



<p>When providing a parent <code>tabnet_model</code> parameter, the model fitting resumes from that model weights
at the following epoch:</p><ul><li><p>last fitted epoch for a model already in torch context</p></li>
<li><p>Last model checkpoint epoch for a model loaded from file</p></li>
<li><p>the epoch related to a checkpoint matching or preceding the <code>from_epoch</code> value if provided
The model fitting metrics append on top of the parent metrics in the returned TabNet model.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="multi-outcome">Multi-outcome<a class="anchor" aria-label="anchor" href="#multi-outcome"></a></h2>



<p>TabNet allows multi-outcome prediction, which is usually named <a href="https://en.wikipedia.org/wiki/Multi-label_classification" class="external-link">multi-label classification</a>
or multi-output regression when outcomes are numerical.
Multi-outcome currently expect outcomes to be either all numeric or all categorical.</p>
    </div>
    <div class="section level2">
    <h2 id="threading">Threading<a class="anchor" aria-label="anchor" href="#threading"></a></h2>



<p>TabNet uses <code>torch</code> as its backend for computation and <code>torch</code> uses all
available threads by default.</p>
<p>You can control the number of threads used by <code>torch</code> with:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>torch<span class="sc">::</span><span class="fu">torch_set_num_threads</span>(<span class="dv">1</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>torch<span class="sc">::</span><span class="fu">torch_set_num_interop_threads</span>(<span class="dv">1</span>)</span></code></pre><p></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ames"</span>, package <span class="op">=</span> <span class="st">"modeldata"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"attrition"</span>, package <span class="op">=</span> <span class="st">"modeldata"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Single-outcome regression using formula specification</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">tabnet_fit</span><span class="op">(</span><span class="va">Sale_Price</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">ames</span>, epochs <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Single-outcome classification using data-frame specification</span></span></span>
<span class="r-in"><span><span class="va">attrition_x</span> <span class="op">&lt;-</span> <span class="va">attrition</span><span class="op">[</span><span class="va">ids</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">attrition</span><span class="op">)</span> <span class="op">==</span> <span class="st">"Attrition"</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">tabnet_fit</span><span class="op">(</span><span class="va">attrition_x</span>, <span class="va">attrition</span><span class="op">$</span><span class="va">Attrition</span>, epochs <span class="op">=</span> <span class="fl">4</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Multi-outcome regression on `Sale_Price` and `Pool_Area` in `ames` dataset using formula,</span></span></span>
<span class="r-in"><span><span class="va">ames_fit</span> <span class="op">&lt;-</span> <span class="fu">tabnet_fit</span><span class="op">(</span><span class="va">Sale_Price</span> <span class="op">+</span> <span class="va">Pool_Area</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">ames</span>, epochs <span class="op">=</span> <span class="fl">4</span>, valid_split <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Multi-label classification on `Attrition` and `JobSatisfaction` in</span></span></span>
<span class="r-in"><span><span class="co">## `attrition` dataset using recipe</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/recipes" class="external-link">recipes</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipe</a></span><span class="op">(</span><span class="va">Attrition</span> <span class="op">+</span> <span class="va">JobSatisfaction</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">attrition</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_normalize.html" class="external-link">step_normalize</a></span><span class="op">(</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_numeric</a></span><span class="op">(</span><span class="op">)</span>, <span class="op">-</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_outcomes</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">attrition_fit</span> <span class="op">&lt;-</span> <span class="fu">tabnet_fit</span><span class="op">(</span><span class="va">rec</span>, data <span class="op">=</span> <span class="va">attrition</span>, epochs <span class="op">=</span> <span class="fl">4</span>, valid_split <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Hierarchical classification on  `acme`</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">acme</span>, package <span class="op">=</span> <span class="st">"data.tree"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">acme_fit</span> <span class="op">&lt;-</span> <span class="fu">tabnet_fit</span><span class="op">(</span><span class="va">acme</span>, epochs <span class="op">=</span> <span class="fl">4</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note: Model's number of epochs should be increased for publication-level results.</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Falbel, Christophe Regouby.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

